
if(EXISTS "${CMAKE_CURRENT_LIST_DIR}/PyCTestPreInit.cmake")
    include("${CMAKE_CURRENT_LIST_DIR}/PyCTestPreInit.cmake")
endif(EXISTS "${CMAKE_CURRENT_LIST_DIR}/PyCTestPreInit.cmake")

if(EXISTS "${CMAKE_CURRENT_LIST_DIR}/Init.cmake")

    include("${CMAKE_CURRENT_LIST_DIR}/Init.cmake")
    include_if("${CMAKE_CURRENT_LIST_DIR}/PyCTestPostInit.cmake")

    message(STATUS "Starting ${MODEL} Coverage - ${CTEST_BUILD_NAME} --")

    setup(Coverage)
    if(NOT "${CTEST_COVERAGE_COMMAND}" STREQUAL "")
        execute_process(COMMAND ${CTEST_COVERAGE_COMMAND} ${CTEST_COVERAGE_EXTRA_FLAGS}
            WORKING_DIRECTORY ${CTEST_BINARY_DIRECTORY})
    endif()
    ctest_coverage(BUILD "${CTEST_BINARY_DIRECTORY}" APPEND RETURN_VALUE rccov)

    # remove the "coverage.xml" file after it has been processed
    # on macOS because the file-system is not case-sensitive
    if(APPLE AND EXISTS "${CTEST_BINARY_DIRECTORY}/coverage.xml")
        execute_process(COMMAND ${CTEST_CMAKE_COMMAND}
            -E remove ${CTEST_BINARY_DIRECTORY}/coverage.xml
            ERROR_QUIET)
    endif()

    submit(Coverage)

    message(STATUS "Finished ${MODEL} Coverage - ${CTEST_BUILD_NAME} --")

endif(EXISTS "${CMAKE_CURRENT_LIST_DIR}/Init.cmake")
