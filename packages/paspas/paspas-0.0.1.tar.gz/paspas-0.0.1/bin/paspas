#!/usr/bin/env python
# -*- coding:utf-8 -*-

import paspas.generator

from argparse import ArgumentParser
import os
import yaml

parser = ArgumentParser()
parser.add_argument("-s", "--site", dest="site", help="site name", required=True)
parser.add_argument("-u", "--user", dest="user", help="user name", required=True)
parser.add_argument("-m", "--master", dest="master", help="master password", required=True)
args = parser.parse_args()

config_path = os.environ['HOME'] + '/.paspas'
config = {}
if os.path.exists(config_path):
    f = open(config_path)
    config = yaml.load(f)
    f.close()

max_length = 0
if config.has_key(args.site) and config[args.site].has_key('max_length'):
    max_length = config[args.site]['max_length']

password = paspas.generator.generate(args.site, args.user, args.master, max_length).strip()
print password,
