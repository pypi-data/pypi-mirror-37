
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Spike train surrogates &#8212; Elephant 0.4.1 documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/elephant_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data format conversions" href="conversion.html" />
    <link rel="prev" title="Stochastic spike train generation" href="spike_train_generation.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="conversion.html" title="Data format conversions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="spike_train_generation.html" title="Stochastic spike train generation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Elephant 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../modules.html" accesskey="U">Function Reference by Module</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/elephant_logo_sidebar.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="spike_train_generation.html"
                        title="previous chapter">Stochastic spike train generation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="conversion.html"
                        title="next chapter">Data format conversions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/spike_train_surrogates.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="spike-train-surrogates">
<h1>Spike train surrogates<a class="headerlink" href="#spike-train-surrogates" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-elephant.spike_train_surrogates"></span><p>Module to generate surrogates of a spike train by randomising its spike times
in different ways (see [1]). Different methods destroy different features of
the original data:</p>
<ul>
<li><dl class="first docutils">
<dt>randomise_spikes:</dt>
<dd><p class="first last">randomly reposition all spikes inside the time interval (t_start, t_stop).
Keeps spike count, generates Poisson spike trains with time-stationary
firing rate</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>dither_spikes:</dt>
<dd><p class="first last">dither each spike time around original position by a random amount;
keeps spike count and firing rates computed on a slow temporal scale;
destroys ISIs, making them more exponentially distributed</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>dither_spike_train:</dt>
<dd><p class="first last">dither the whole input spike train (i.e. all spikes equally) by a random
amount; keeps spike count, ISIs, and firing rates computed on a slow
temporal scale</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>jitter_spikes:</dt>
<dd><p class="first last">discretise the full time interval (t_start, t_stop) into time segments
and locally randomise the spike times (see randomise_spikes) inside each
segment. Keeps spike count inside each segment and creates locally Poisson
spike trains with locally time-stationary rates</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>shuffle_isis:</dt>
<dd><p class="first last">shuffle the inter-spike intervals (ISIs) of the spike train randomly,
keeping the first spike time fixed and generating the others from the
new sequence of ISIs. Keeps spike count and ISIs, flattens the firing rate
profile</p>
</dd>
</dl>
</li>
</ul>
<dl class="docutils">
<dt>[1] Louis et al (2010) Surrogate Spike Train Generation Through Dithering in</dt>
<dd>Operational Time. Front Comput Neurosci. 2010; 4: 127.</dd>
</dl>
<p>Original implementation by: Emiliano Torre [<a class="reference external" href="mailto:e&#46;torre&#37;&#52;&#48;fz-juelich&#46;de">e<span>&#46;</span>torre<span>&#64;</span>fz-juelich<span>&#46;</span>de</a>]</p>
<dl class="function">
<dt id="elephant.spike_train_surrogates.dither_spike_train">
<code class="descclassname">elephant.spike_train_surrogates.</code><code class="descname">dither_spike_train</code><span class="sig-paren">(</span><em>spiketrain</em>, <em>shift</em>, <em>n=1</em>, <em>decimals=None</em>, <em>edges=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/spike_train_surrogates.html#dither_spike_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.spike_train_surrogates.dither_spike_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates surrogates of a neo.SpikeTrain by spike train shifting.</p>
<p>The surrogates are obtained by shifting the whole spike train by a
random amount (independent for each surrogate). Thus, ISIs and temporal
correlations within the spike train are kept. For small shifts, the
firing rate profile is also kept with reasonable accuracy.</p>
<p>The surrogates retain the <code class="xref py py-attr docutils literal notranslate"><span class="pre">t_start</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">t_stop</span></code> of the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code>. Spikes moved beyond this range are lost or moved to
the range’s ends, depending on the parameter edge.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrain</strong> :  neo.SpikeTrain</p>
<blockquote>
<div><p>The spike train from which to generate the surrogates</p>
</div></blockquote>
<p><strong>shift</strong> : quantities.Quantity</p>
<blockquote>
<div><p>Amount of shift. spiketrain is shifted by a random amount uniformly
drawn from the range ]-shift, +shift[.</p>
</div></blockquote>
<p><strong>n</strong> : int (optional)</p>
<blockquote>
<div><p>Number of surrogates to be generated.
Default: 1</p>
</div></blockquote>
<p><strong>decimals</strong> : int or None (optional)</p>
<blockquote>
<div><p>Number of decimal points for every spike time in the surrogates
If None, machine precision is used.
Default: None</p>
</div></blockquote>
<p><strong>edges</strong> : bool</p>
<blockquote>
<div><p>For surrogate spikes falling outside the range <cite>[spiketrain.t_start,
spiketrain.t_stop)</cite>, whether to drop them out (for edges = True) or set
that to the range’s closest end (for edges = False).
Default: True</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of SpikeTrain</p>
<blockquote class="last">
<div><p>A list of spike trains, each obtained from spiketrain by randomly
dithering its spikes. The range of the surrogate spike trains is the
same as <code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">quantities</span> <span class="k">as</span> <span class="nn">pq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">neo</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">neo</span><span class="o">.</span><span class="n">SpikeTrain</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">dither_spike_train</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">)</span>   
<span class="go">[&lt;SpikeTrain(array([  96.53801903,  248.57047376,  601.48865767,</span>
<span class="go"> 815.67209811]) * ms, [0.0 ms, 1000.0 ms])&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">dither_spike_train</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>   
<span class="go">[&lt;SpikeTrain(array([  92.89084054,  242.89084054,  592.89084054,</span>
<span class="go">    792.89084054]) * ms, [0.0 ms, 1000.0 ms])&gt;,</span>
<span class="go"> &lt;SpikeTrain(array([  84.61079043,  234.61079043,  584.61079043,</span>
<span class="go">    784.61079043]) * ms, [0.0 ms, 1000.0 ms])&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">dither_spike_train</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   
<span class="go">[&lt;SpikeTrain(array([  82.,  232.,  582.,  782.]) * ms,</span>
<span class="go">    [0.0 ms, 1000.0 ms])&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="elephant.spike_train_surrogates.dither_spikes">
<code class="descclassname">elephant.spike_train_surrogates.</code><code class="descname">dither_spikes</code><span class="sig-paren">(</span><em>spiketrain</em>, <em>dither</em>, <em>n=1</em>, <em>decimals=None</em>, <em>edges=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/spike_train_surrogates.html#dither_spikes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.spike_train_surrogates.dither_spikes" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates surrogates of a spike train by spike dithering.</p>
<p>The surrogates are obtained by uniformly dithering times around the
original position. The dithering is performed independently for each
surrogate.</p>
<p>The surrogates retain the <code class="xref py py-attr docutils literal notranslate"><span class="pre">t_start</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">t_stop</span></code> of the
original <cite>SpikeTrain</cite> object. Spikes moved beyond this range are lost or
moved to the range’s ends, depending on the parameter edge.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrain</strong> :  neo.SpikeTrain</p>
<blockquote>
<div><p>The spike train from which to generate the surrogates</p>
</div></blockquote>
<p><strong>dither</strong> : quantities.Quantity</p>
<blockquote>
<div><p>Amount of dithering. A spike at time t is placed randomly within
]t-dither, t+dither[.</p>
</div></blockquote>
<p><strong>n</strong> : int (optional)</p>
<blockquote>
<div><p>Number of surrogates to be generated.
Default: 1</p>
</div></blockquote>
<p><strong>decimals</strong> : int or None (optional)</p>
<blockquote>
<div><p>Number of decimal points for every spike time in the surrogates
If None, machine precision is used.
Default: None</p>
</div></blockquote>
<p><strong>edges</strong> : bool (optional)</p>
<blockquote>
<div><p>For surrogate spikes falling outside the range
<cite>[spiketrain.t_start, spiketrain.t_stop)</cite>, whether to drop them out
(for edges = True) or set that to the range’s closest end
(for edges = False).
Default: True</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of neo.SpikeTrain</p>
<blockquote class="last">
<div><p>A list of <cite>neo.SpikeTrain</cite>, each obtained from <code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code> by
randomly dithering its spikes. The range of the surrogate spike trains
is the same as <code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">quantities</span> <span class="k">as</span> <span class="nn">pq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">neo</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">neo</span><span class="o">.</span><span class="n">SpikeTrain</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">dither_spikes</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">dither</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">)</span>   
<span class="go">[&lt;SpikeTrain(array([  96.53801903,  248.57047376,  601.48865767,</span>
<span class="go"> 815.67209811]) * ms, [0.0 ms, 1000.0 ms])&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">dither_spikes</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">dither</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>   
<span class="go">[&lt;SpikeTrain(array([ 104.24942044,  246.0317873 ,  584.55938657,</span>
<span class="go">    818.84446913]) * ms, [0.0 ms, 1000.0 ms])&gt;,</span>
<span class="go"> &lt;SpikeTrain(array([ 111.36693058,  235.15750163,  618.87388515,</span>
<span class="go">    786.1807108 ]) * ms, [0.0 ms, 1000.0 ms])&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">dither_spikes</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">dither</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   
<span class="go">[&lt;SpikeTrain(array([  81.,  242.,  595.,  799.]) * ms,</span>
<span class="go">    [0.0 ms, 1000.0 ms])&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="elephant.spike_train_surrogates.jitter_spikes">
<code class="descclassname">elephant.spike_train_surrogates.</code><code class="descname">jitter_spikes</code><span class="sig-paren">(</span><em>spiketrain</em>, <em>binsize</em>, <em>n=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/spike_train_surrogates.html#jitter_spikes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.spike_train_surrogates.jitter_spikes" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates surrogates of a <code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code> by spike jittering.</p>
<p>The surrogates are obtained by defining adjacent time bins spanning the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code> range, and random re-positioning (independently for each
surrogate) each spike in the time bin it falls into.</p>
<p>The surrogates retain the <code class="xref py py-attr docutils literal notranslate"><span class="pre">t_start</span> <span class="pre">and</span> <span class="pre">:attr:`t_stop</span></code> of the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spike</span> <span class="pre">train</span></code>. Note that within each time bin the surrogate
<cite>neo.SpikeTrain</cite> objects are locally poissonian (the inter-spike-interval
are exponentially distributed).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrain</strong> :  neo.SpikeTrain</p>
<blockquote>
<div><p>The spike train from which to generate the surrogates</p>
</div></blockquote>
<p><strong>binsize</strong> : quantities.Quantity</p>
<blockquote>
<div><p>Size of the time bins within which to randomise the spike times.
Note: the last bin arrives until <cite>spiketrain.t_stop</cite> and might have
width different from <cite>binsize</cite>.</p>
</div></blockquote>
<p><strong>n</strong> : int (optional)</p>
<blockquote>
<div><p>Number of surrogates to be generated.
Default: 1</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of SpikeTrain</p>
<blockquote class="last">
<div><p>A list of spike trains, each obtained from <cite>spiketrain</cite> by randomly
replacing its spikes within bins of user-defined width. The range of the
surrogate spike trains is the same as <cite>spiketrain</cite>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">quantities</span> <span class="k">as</span> <span class="nn">pq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">neo</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">neo</span><span class="o">.</span><span class="n">SpikeTrain</span><span class="p">([</span><span class="mi">80</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">480</span><span class="p">]</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">jitter_spikes</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">binsize</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">)</span>   
<span class="go">[&lt;SpikeTrain(array([  98.82898293,  178.45805954,  346.93993867,</span>
<span class="go">    461.34268507]) * ms, [0.0 ms, 1000.0 ms])&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">jitter_spikes</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">binsize</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>   
<span class="go">[&lt;SpikeTrain(array([  97.15720041,  199.06945744,  397.51928207,</span>
<span class="go">    402.40065162]) * ms, [0.0 ms, 1000.0 ms])&gt;,</span>
<span class="go"> &lt;SpikeTrain(array([  80.74513157,  173.69371317,  338.05860962,</span>
<span class="go">    495.48869981]) * ms, [0.0 ms, 1000.0 ms])&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">jitter_spikes</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">binsize</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">)</span>   
<span class="go">[&lt;SpikeTrain(array([  4.55064897e-01,   1.31927046e+02,   3.57846265e+02,</span>
<span class="go">     4.69370604e+02]) * ms, [0.0 ms, 1000.0 ms])&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="elephant.spike_train_surrogates.randomise_spikes">
<code class="descclassname">elephant.spike_train_surrogates.</code><code class="descname">randomise_spikes</code><span class="sig-paren">(</span><em>spiketrain</em>, <em>n=1</em>, <em>decimals=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/spike_train_surrogates.html#randomise_spikes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.spike_train_surrogates.randomise_spikes" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates surrogates of a spike trains by spike time randomisation.</p>
<p>The surrogates are obtained by keeping the spike count of the original
<cite>SpikeTrain</cite> object, but placing them randomly into the interval
<cite>[spiketrain.t_start, spiketrain.t_stop]</cite>.
This generates independent Poisson neo.SpikeTrain objects (exponentially
distributed inter-spike intervals) while keeping the spike count as in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrain</strong> :  neo.SpikeTrain</p>
<blockquote>
<div><p>The spike train from which to generate the surrogates</p>
</div></blockquote>
<p><strong>n</strong> : int (optional)</p>
<blockquote>
<div><p>Number of surrogates to be generated.
Default: 1</p>
</div></blockquote>
<p><strong>decimals</strong> : int or None (optional)</p>
<blockquote>
<div><p>Number of decimal points for every spike time in the surrogates
If None, machine precision is used.
Default: None</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of neo.SpikeTrain object(s)</p>
<blockquote class="last">
<div><p>A list of <cite>neo.SpikeTrain</cite> objects, each obtained from <code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code>
by randomly dithering its spikes. The range of the surrogate spike trains
is the same as <code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">quantities</span> <span class="k">as</span> <span class="nn">pq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">neo</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">neo</span><span class="o">.</span><span class="n">SpikeTrain</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">randomise_spikes</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>   
<span class="go">    [&lt;SpikeTrain(array([ 131.23574603,  262.05062963,  549.84371387,</span>
<span class="go">                        940.80503832]) * ms, [0.0 ms, 1000.0 ms])&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">randomise_spikes</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>   
<span class="go">    [&lt;SpikeTrain(array([  84.53274955,  431.54011743,  733.09605806,</span>
<span class="go">          852.32426583]) * ms, [0.0 ms, 1000.0 ms])&gt;,</span>
<span class="go">     &lt;SpikeTrain(array([ 197.74596726,  528.93517359,  567.44599968,</span>
<span class="go">          775.97843799]) * ms, [0.0 ms, 1000.0 ms])&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">randomise_spikes</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   
<span class="go">    [&lt;SpikeTrain(array([  29.,  667.,  720.,  774.]) * ms,</span>
<span class="go">          [0.0 ms, 1000.0 ms])&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="elephant.spike_train_surrogates.shuffle_isis">
<code class="descclassname">elephant.spike_train_surrogates.</code><code class="descname">shuffle_isis</code><span class="sig-paren">(</span><em>spiketrain</em>, <em>n=1</em>, <em>decimals=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/spike_train_surrogates.html#shuffle_isis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.spike_train_surrogates.shuffle_isis" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates surrogates of a neo.SpikeTrain object by inter-spike-interval
(ISI) shuffling.</p>
<p>The surrogates are obtained by randomly sorting the ISIs of the given input
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code>. This generates independent <cite>SpikeTrain</cite> object(s) with
same ISI distribution and spike count as in <code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code>, while
destroying temporal dependencies and firing rate profile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrain</strong> :  neo.SpikeTrain</p>
<blockquote>
<div><p>The spike train from which to generate the surrogates</p>
</div></blockquote>
<p><strong>n</strong> : int (optional)</p>
<blockquote>
<div><p>Number of surrogates to be generated.
Default: 1</p>
</div></blockquote>
<p><strong>decimals</strong> : int or None (optional)</p>
<blockquote>
<div><p>Number of decimal points for every spike time in the surrogates
If None, machine precision is used.
Default: None</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of SpikeTrain</p>
<blockquote class="last">
<div><p>A list of spike trains, each obtained from <cite>spiketrain</cite> by random ISI
shuffling. The range of the surrogate <cite>neo.SpikeTrain</cite> objects is the
same as <code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">quantities</span> <span class="k">as</span> <span class="nn">pq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">neo</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">neo</span><span class="o">.</span><span class="n">SpikeTrain</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shuffle_isis</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>   
<span class="go">    [&lt;SpikeTrain(array([ 200.,  350.,  700.,  800.]) * ms,</span>
<span class="go">             [0.0 ms, 1000.0 ms])&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shuffle_isis</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>   
<span class="go">    [&lt;SpikeTrain(array([ 100.,  300.,  450.,  800.]) * ms,</span>
<span class="go">          [0.0 ms, 1000.0 ms])&gt;,</span>
<span class="go">     &lt;SpikeTrain(array([ 200.,  350.,  700.,  800.]) * ms,</span>
<span class="go">          [0.0 ms, 1000.0 ms])&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="elephant.spike_train_surrogates.surrogates">
<code class="descclassname">elephant.spike_train_surrogates.</code><code class="descname">surrogates</code><span class="sig-paren">(</span><em>spiketrain</em>, <em>n=1</em>, <em>surr_method='dither_spike_train'</em>, <em>dt=None</em>, <em>decimals=None</em>, <em>edges=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/spike_train_surrogates.html#surrogates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.spike_train_surrogates.surrogates" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates surrogates of a <code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code> by a desired generation
method.</p>
<p>This routine is a wrapper for the other surrogate generators in the
module.</p>
<p>The surrogates retain the <code class="xref py py-attr docutils literal notranslate"><span class="pre">t_start</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">t_stop</span></code> of the
original <code class="xref py py-attr docutils literal notranslate"><span class="pre">spiketrain</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrain</strong> :  neo.SpikeTrain</p>
<blockquote>
<div><p>The spike train from which to generate the surrogates</p>
</div></blockquote>
<p><strong>n</strong> : int, optional</p>
<blockquote>
<div><p>Number of surrogates to be generated.
Default: 1</p>
</div></blockquote>
<p><strong>surr_method</strong> : str, optional</p>
<blockquote>
<div><p>The method to use to generate surrogate spike trains. Can be one of:
* ‘dither_spike_train’: see surrogates.dither_spike_train() [dt needed]
* ‘dither_spikes’: see surrogates.dither_spikes() [dt needed]
* ‘jitter_spikes’: see surrogates.jitter_spikes() [dt needed]
* ‘randomise_spikes’: see surrogates.randomise_spikes()
* ‘shuffle_isis’: see surrogates.shuffle_isis()
Default: ‘dither_spike_train’</p>
</div></blockquote>
<p><strong>dt</strong> : quantities.Quantity, optional</p>
<blockquote>
<div><p>For methods shifting spike times randomly around their original time
(spike dithering, train shifting) or replacing them randomly within a
certain window (spike jittering), dt represents the size of that
shift / window. For other methods, dt is ignored.
Default: None</p>
</div></blockquote>
<p><strong>decimals</strong> : int or None, optional</p>
<blockquote>
<div><p>Number of decimal points for every spike time in the surrogates
If None, machine precision is used.
Default: None</p>
</div></blockquote>
<p><strong>edges</strong> : bool</p>
<blockquote>
<div><p>For surrogate spikes falling outside the range <cite>[spiketrain.t_start,
spiketrain.t_stop)</cite>, whether to drop them out (for edges = True) or set
that to the range’s closest end (for edges = False).
Default: True</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of neo.SpikeTrain objects</p>
<blockquote class="last">
<div><p>A list of spike trains, each obtained from <cite>spiketrain</cite> by randomly
dithering its spikes. The range of the surrogate <cite>neo.SpikeTrain</cite>
object(s) is the same as <cite>spiketrain</cite>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="conversion.html" title="Data format conversions"
             >next</a> |</li>
        <li class="right" >
          <a href="spike_train_generation.html" title="Stochastic spike train generation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Elephant 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../modules.html" >Function Reference by Module</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2017, Elephant authors and contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.0.
    </div>
  </body>
</html>