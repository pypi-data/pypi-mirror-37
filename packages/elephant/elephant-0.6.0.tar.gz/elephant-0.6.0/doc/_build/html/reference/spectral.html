
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Spectral analysis &#8212; Elephant 0.4.1 documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/elephant_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Current source density analysis" href="current_source_density.html" />
    <link rel="prev" title="Signal processing" href="signal_processing.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="current_source_density.html" title="Current source density analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="signal_processing.html" title="Signal processing"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Elephant 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../modules.html" accesskey="U">Function Reference by Module</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/elephant_logo_sidebar.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="signal_processing.html"
                        title="previous chapter">Signal processing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="current_source_density.html"
                        title="next chapter">Current source density analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/spectral.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-elephant.spectral">
<span id="spectral-analysis"></span><h1>Spectral analysis<a class="headerlink" href="#module-elephant.spectral" title="Permalink to this headline">¶</a></h1>
<p>Identification of spectral properties in analog signals (e.g., the power
spectrum).</p>
<dl class="function">
<dt id="elephant.spectral.welch_cohere">
<code class="descclassname">elephant.spectral.</code><code class="descname">welch_cohere</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>num_seg=8</em>, <em>len_seg=None</em>, <em>freq_res=None</em>, <em>overlap=0.5</em>, <em>fs=1.0</em>, <em>window='hanning'</em>, <em>nfft=None</em>, <em>detrend='constant'</em>, <em>scaling='density'</em>, <em>axis=-1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/spectral.html#welch_cohere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.spectral.welch_cohere" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates coherence between a given pair of analog signals. The estimation
is performed with Welch’s method: the given pair of data are cut into short
segments, cross-spectra are calculated for each pair of segments, and the
cross-spectra are averaged and normalized by respective auto_spectra. By
default the data are cut into 8 segments with 50% overlap between
neighboring segments. These numbers can be changed through respective
parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x, y: Neo AnalogSignal or Quantity array or Numpy ndarray</strong></p>
<blockquote>
<div><p>A pair of time series data, between which coherence is computed. The
shapes and the sampling frequencies of <cite>x</cite> and <cite>y</cite> must be identical.
When <cite>x</cite> and <cite>y</cite> are not of AnalogSignal, sampling frequency
should be specified through the keyword argument <cite>fs</cite>, otherwise the
default value (<cite>fs=1.0</cite>) is used.</p>
</div></blockquote>
<p><strong>num_seg: int, optional</strong></p>
<blockquote>
<div><p>Number of segments. The length of segments is adjusted so that
overlapping segments cover the entire stretch of the given data. This
parameter is ignored if <em>len_seg</em> or <em>freq_res</em> is given. Default is 8.</p>
</div></blockquote>
<p><strong>len_seg: int, optional</strong></p>
<blockquote>
<div><p>Length of segments. This parameter is ignored if <em>freq_res</em> is given.
Default is None (determined from other parameters).</p>
</div></blockquote>
<p><strong>freq_res: Quantity or float, optional</strong></p>
<blockquote>
<div><p>Desired frequency resolution of the obtained coherence estimate in
terms of the interval between adjacent frequency bins. When given as a
float, it is taken as frequency in Hz. Default is None (determined from
other parameters).</p>
</div></blockquote>
<p><strong>overlap: float, optional</strong></p>
<blockquote>
<div><p>Overlap between segments represented as a float number between 0 (no
overlap) and 1 (complete overlap). Default is 0.5 (half-overlapped).</p>
</div></blockquote>
<p><strong>fs: Quantity array or float, optional</strong></p>
<blockquote>
<div><p>Specifies the sampling frequency of the input time series. When the
input time series are given as AnalogSignal, the sampling
frequency is taken from their attribute and this parameter is ignored.
Default is 1.0.</p>
</div></blockquote>
<p><strong>window, nfft, detrend, scaling, axis: optional</strong></p>
<blockquote>
<div><p>These arguments are directly passed on to a helper function
<cite>elephant.spectral._welch()</cite>. See the respective descriptions in the
docstring of <cite>elephant.spectral._welch()</cite> for usage.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">freqs: Quantity array or Numpy ndarray</p>
<blockquote>
<div><p>Frequencies associated with the estimates of coherency and phase lag.
<cite>freqs</cite> is always a 1-dimensional array irrespective of the shape of
the input data. Quantity array is returned if <cite>x</cite> and <cite>y</cite> are of
AnalogSignal or Quantity array. Otherwise Numpy ndarray containing
frequency in Hz is returned.</p>
</div></blockquote>
<p>coherency: Numpy ndarray</p>
<blockquote>
<div><p>Estimate of coherency between the input time series. For each frequency
coherency takes a value between 0 and 1, with 0 or 1 representing no or
perfect coherence, respectively. When the input arrays <cite>x</cite> and <cite>y</cite> are
multi-dimensional, <cite>coherency</cite> is of the same shape as the inputs and
frequency is indexed along either the first or the last axis depending
on the type of the input: when the input is AnalogSignal, the
first axis indexes frequency, otherwise the last axis does.</p>
</div></blockquote>
<p>phase_lag: Quantity array or Numpy ndarray</p>
<blockquote class="last">
<div><p>Estimate of phase lag in radian between the input time series. For each
frequency phase lag takes a value between -PI and PI, positive values
meaning phase precession of <cite>x</cite> ahead of <cite>y</cite> and vice versa. Quantity
array is returned if <cite>x</cite> and <cite>y</cite> are of AnalogSignal or Quantity
array. Otherwise Numpy ndarray containing phase lag in radian is
returned. The axis for frequency index is determined in the same way as
for <cite>coherency</cite>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="elephant.spectral.welch_psd">
<code class="descclassname">elephant.spectral.</code><code class="descname">welch_psd</code><span class="sig-paren">(</span><em>signal</em>, <em>num_seg=8</em>, <em>len_seg=None</em>, <em>freq_res=None</em>, <em>overlap=0.5</em>, <em>fs=1.0</em>, <em>window='hanning'</em>, <em>nfft=None</em>, <em>detrend='constant'</em>, <em>return_onesided=True</em>, <em>scaling='density'</em>, <em>axis=-1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/spectral.html#welch_psd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.spectral.welch_psd" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates power spectrum density (PSD) of a given AnalogSignal using
Welch’s method, which works in the following steps:</p>
<blockquote>
<div><ol class="arabic">
<li><dl class="first docutils">
<dt>cut the given data into several overlapping segments. The degree of</dt>
<dd><p class="first last">overlap can be specified by parameter <em>overlap</em> (default is 0.5,
i.e. segments are overlapped by the half of their length).
The number and the length of the segments are determined according
to parameter <em>num_seg</em>, <em>len_seg</em> or <em>freq_res</em>. By default, the
data is cut into 8 segments.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>apply a window function to each segment. Hanning window is used by</dt>
<dd><p class="first last">default. This can be changed by giving a window function or an
array as parameter <em>window</em> (for details, see the docstring of
<cite>scipy.signal.welch()</cite>)</p>
</dd>
</dl>
</li>
<li><p class="first">compute the periodogram of each segment</p>
</li>
<li><p class="first">average the obtained periodograms to yield PSD estimate</p>
</li>
</ol>
</div></blockquote>
<p>These steps are implemented in <cite>scipy.signal</cite>, and this function is a
wrapper which provides a proper set of parameters to
<cite>scipy.signal.welch()</cite>. Some parameters for scipy.signal.welch(), such as
<cite>nfft</cite>, <cite>detrend</cite>, <cite>window</cite>, <cite>return_onesided</cite> and <cite>scaling</cite>, also works
for this function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>signal: Neo AnalogSignal or Quantity array or Numpy ndarray</strong></p>
<blockquote>
<div><p>Time series data, of which PSD is estimated. When a Quantity array or
Numpy ndarray is given, sampling frequency should be given through the
keyword argument <cite>fs</cite>, otherwise the default value (<cite>fs=1.0</cite>) is used.</p>
</div></blockquote>
<p><strong>num_seg: int, optional</strong></p>
<blockquote>
<div><p>Number of segments. The length of segments is adjusted so that
overlapping segments cover the entire stretch of the given data. This
parameter is ignored if <em>len_seg</em> or <em>freq_res</em> is given. Default is 8.</p>
</div></blockquote>
<p><strong>len_seg: int, optional</strong></p>
<blockquote>
<div><p>Length of segments. This parameter is ignored if <em>freq_res</em> is given.
Default is None (determined from other parameters).</p>
</div></blockquote>
<p><strong>freq_res: Quantity or float, optional</strong></p>
<blockquote>
<div><p>Desired frequency resolution of the obtained PSD estimate in terms of
the interval between adjacent frequency bins. When given as a float, it
is taken as frequency in Hz. Default is None (determined from other
parameters).</p>
</div></blockquote>
<p><strong>overlap: float, optional</strong></p>
<blockquote>
<div><p>Overlap between segments represented as a float number between 0 (no
overlap) and 1 (complete overlap). Default is 0.5 (half-overlapped).</p>
</div></blockquote>
<p><strong>fs: Quantity array or float, optional</strong></p>
<blockquote>
<div><p>Specifies the sampling frequency of the input time series. When the
input is given as an AnalogSignal, the sampling frequency is taken
from its attribute and this parameter is ignored. Default is 1.0.</p>
</div></blockquote>
<p><strong>window, nfft, detrend, return_onesided, scaling, axis: optional</strong></p>
<blockquote>
<div><p>These arguments are directly passed on to scipy.signal.welch(). See the
respective descriptions in the docstring of <cite>scipy.signal.welch()</cite> for
usage.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">freqs: Quantity array or Numpy ndarray</p>
<blockquote>
<div><p>Frequencies associated with the power estimates in <cite>psd</cite>. <cite>freqs</cite> is
always a 1-dimensional array irrespective of the shape of the input
data. Quantity array is returned if <cite>signal</cite> is AnalogSignal or
Quantity array. Otherwise Numpy ndarray containing frequency in Hz is
returned.</p>
</div></blockquote>
<p>psd: Quantity array or Numpy ndarray</p>
<blockquote class="last">
<div><p>PSD estimates of the time series in <cite>signal</cite>. Quantity array is
returned if <cite>data</cite> is AnalogSignal or Quantity array. Otherwise
Numpy ndarray is returned.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="current_source_density.html" title="Current source density analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="signal_processing.html" title="Signal processing"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Elephant 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../modules.html" >Function Reference by Module</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2017, Elephant authors and contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.0.
    </div>
  </body>
</html>